model AdminToken {
  id    Int    @id
  token String
}
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Complaint {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  status      String   @default("PENDING")
  createdAt   DateTime @default(now())
  studentId   Int
  student     student  @relation(fields: [studentId], references: [id], onDelete: Cascade)
}

model user {
  id             Int        @id @unique @default(autoincrement())
  email          String     @unique
  password       String
  role           UserRole
  sex            GENDER
  status         UserStatus @default(ACTIVE)
  img            String?
  lastLogin      DateTime?
  phone          String
  address        String
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  studentProfile student?
}

model student {
  first_name      String?
  last_name       String?
  dob             DateTime?
  department      String?
  id              Int         @id @default(autoincrement())
  matricNumber    String      @unique
  profileComplete Boolean     @default(false)
  userId          Int         @unique
  type            Type?       @default(RESIDENT)
  bedspace        Bedspace?
  complaints      Complaint[]
  user            user        @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Notice {
  id                String     @id @default(cuid())
  type              NoticeType
  createdAt         DateTime   @default(now())
  body              String
  fileUrl           String?
  headline          String
  imageUrl          String?
  ps                String?
  subhead           String?
  visibleToManagers Boolean    @default(false)
  visibleToPorters  Boolean    @default(false)
  visibleToStudents Boolean    @default(false)
}

model Hostel {
  id        String   @id @default(uuid())
  name      String   @unique
  address   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  blocks    Block[]
}

model Block {
  id        String       @id @default(uuid())
  name      String
  hostelId  String
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  hostel    Hostel       @relation(fields: [hostelId], references: [id], onDelete: Cascade)
  rooms     HostelRoom[]
}

model HostelRoom {
  id         String     @id @default(uuid())
  roomNumber String
  capacity   Int        @default(4)
  blockId    String
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  bedspaces  Bedspace[]
  block      Block      @relation(fields: [blockId], references: [id], onDelete: Cascade)
}

model Bedspace {
  id         String     @id @default(uuid())
  number     String
  roomId     String
  studentId  Int?       @unique
  isOccupied Boolean    @default(false)
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  room       HostelRoom @relation(fields: [roomId], references: [id], onDelete: Cascade)
  student    student?   @relation(fields: [studentId], references: [id])
}

model Authority {
  id        String        @id @default(cuid())
  fullName  String
  phone     String
  type      AuthorityType
  message   String
  createdAt DateTime      @default(now())
}

enum AuthorityType {
  PRINCIPAL
  VICE_PRINCIPAL
  ADMINISTRATOR
  PRESIDENT
  DIRECTOR
  MANAGER
  SUPERVISOR
  COORDINATOR
}

enum Type {
  RESIDENT
  VISITOR
}

enum NoticeType {
  UNIVERSITY
  HOSTEL
  INFORMAL
}

enum AudienceType {
  ALL
  STAFF
  STUDENTS
}

enum GENDER {
  MALE
  FEMALE
}

enum DayOfWeek {
  SATURDAY
  SUNDAY
  MONDAY
  TUESDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
}

enum UserRole {
  ADMIN
  MANAGER
  PORTER
  STUDENT
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}
